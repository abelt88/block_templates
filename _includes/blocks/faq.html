<section id="section-{{forloop.index}}" class="">
  <div class="max-width mx-auto py-4">

    <h2 class="py-4">{{block.header}}</h2>

    {% for question in block.questions %}

    <div class="questions border-color border-2 {% if forloop.first%} border-t-2 {% else %}border-t-0 {% endif %} border-b-0 p-4">
      <h3 class="relative">{{question.text}}
        <div class="faq-question-icon absolute top-2 right-0">
          <span class="border-b border-color w-4 block rotate-90 transition-all duration-1000 leading-none relative top-[1.4px]"></span>
          <span class="border-b border-color w-4 block leading-none"></span>
        </div>
      </h3>
    </div>

    <div class="answers overflow-hidden border-color border-2 border-t-0 transition-all duration-1000" style="max-height: 0;">
      <div class="answer-content p-4">
        <h3 class="">{{question.answer_html}}</h3>
      </div>
    </div>

    {% endfor %}

</div>
</section>

<!-- JavaScript -->
<script>

  const expandButtons = document.querySelectorAll(".questions");
  
  function expand() {
    
    console.log(this.previousElementSibling)
    console.log(this.nextElementSibling)
    console.log(
      this.nextElementSibling.style.maxHeight
    )
    console.log(this.nextElementSibling.querySelector('.answer-content').clientHeight)

    this.classList.toggle('active')

    let targetHeight = this.nextElementSibling.querySelector('.answer-content').clientHeight

  if (this.nextElementSibling.style.maxHeight == '0px') {
    this.nextElementSibling.style.maxHeight = `${targetHeight}px`
    
  }  else {
    this.nextElementSibling.style.maxHeight = "0px"
  }
    
  }
  
  expandButtons.forEach(button => {
    button.addEventListener("click",expand);
  })
  
  </script>

<!-- Mini Style Sheet -->
<style>

.faq-question-icon {
  height: 1rem;
  width: 1rem;
}

.questions.active .rotate-90 {
  opacity: 0;
  transform: rotate(180deg);
  /* transition: all 0.4s ease-out; */

}

</style>
